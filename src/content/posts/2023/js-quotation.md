---
# layout: ~/layouts/Blog.astro
published: 2023-02-04
updated:
tags: [JavaScript, programming]
---

# JavaScriptの引用符は'と"と`のどれを使うべきか

正直、好みで選んでいいと思います。
`null`と`undefined`や関数宣言とアロー関数などの頭を悩ませる選択が多いことでおなじみのJavaScriptですが、
文字列をどのように作ろうとアプリケーションの設計に影響を与えることはほとんど無いでしょう。
しかし、気持ちよくコードを書くにあたってしっかりとした基準を持っておくというのはやっぱり大切だと思うので、
私なりの判断基準を書き残しておきます。

## TL;DR

- 式を埋め込みたい -> バッククォート文字
- 普通の文字列 -> シングルクォーテーション
- ダブルクォーテーションを含む文字列の場合のみシングルクォーテーションを使う

## 文字列リテラルとテンプレートリテラルは使い分ける

テンプレートリテラルは普通の文字列の上位互換なんだから、全部バッククォート文字で書けば良くね？と思ったこともありました。
しかし、シングルクォーテーションまたはダブルクォーテーションで作成する文字列リテラルと、
バッククォート文字で作成し、式を埋め込むことのできるテンプレートリテラルは当然ながら別の構文として扱われます。
具体的には、`import`するモジュール名や、厳格モードを呼び出すためのファイル先頭の`use strict`ではテンプレートリテラルは使えません。
また、テンプレートリテラルはリテラル内で改行できたり、
メタプログラミングのためのタグ付きテンプレートリテラルという形式が存在するなどの特徴があります。
タグ付きテンプレートリテラルは[emotion](https://emotion.sh/docs/introduction)や[styled-components](https://styled-components.com)などのCSS-in-JSや、
[Apollo Client](https://www.apollographql.com/docs/react)のGraphQLクエリの記述なんかに使われているところを目にするかもしれません。

このように、文字列リテラルとテンプレートリテラルはそもそも機能が異なるため、使い分けるのが吉でしょう。
基本は文字列リテラルを使い、変数や式を埋め込みたいときだけテンプレートリテラルを使うのが自然だと思います。
でもそれだと後から式を埋め込みたいときに面倒です。
そんなときはエディタの機能やプラグインを探せば、引用符の置換機能が見つかるはずです。
参考までに、私はNeovimで[nvim-surround](https://github.com/kylechui/nvim-surround)、
VSCodeで[Quick and Simple Text Selection](https://marketplace.visualstudio.com/items?itemName=dbankier.vscode-quick-select)を使っています。

## シングルクォーテーション vs ダブルクォーテーション

前提として、文字列中に引用符を含む場合、できるだけバックスラッシュによる明示的なエスケープが必要ない選択をします。
例として、*don't worry*ではダブルクォーテーションを用い、*He said, "Hi."*ではシングルクォーテーションを使います。
いちいちバックスラッシュを挿入するのは面倒な上に見づらいためです。
では、文字列リテラルではシングルクォーテーションとダブルクォーテーションのどちらを使うべきなのか比較してみます。

シングルクォーテーションのメリットは、なんといっても見た目がスッキリしているという点に尽きるでしょう。
個人的には、見た目はシングルクォーテーションの方が圧倒的に好みです。
パッと見たときに、より洗練された美しいコードに見えます。パッと見たときだけですが。

対してダブルクォーテーションのメリットは、C言語をはじめとした伝統的ないくつかの言語の文字列表現との整合性がとれること、
フォーマッタと相性の良いことが挙げられます。
他言語との整合性に関しては、あまり大きなメリットとは言えません。
多少直感的であるのは良いことですが、そもそもC言語の例では文字と文字列が別物なので、
その作法をJavaScriptに持ち込むのはナンセンスなのかもしれません。
文字列はダブルクォーテーションで囲む！というおぼろげな固定観念に沿う形の方が多少しっくりくるというだけの話です。

また、代表的なJavaScriptのフォーマッタである[Prettier](https://prettier.io/)では、
デフォルトの設定で文字列リテラルにダブルクォーテーションが使われるようになっています。
これは、エスケープの手間とJSONとの互換性を考慮しての判断です。

<!-- textlint-disable preset-ja-technical-writing/no-doubled-joshi -->

エスケープの手間については、英語では文中にシングルクォーテーションが現れるケースが多いため、
その際楽になるという意図です。反対にダブルクォーテーションを含む文字列は明示的なエスケープが必要になるため、
大きなメリットには成り得ません。そもそもプログラム中に自然言語の文をハードコードする機会自体あまりないため
気にすべきポイントではない気がします。JSONとの互換性もまた、コピペで動いてくれるのは便利である反面、
引用符の齟齬程度であればフォーマッタの守備範囲内であるため大きなメリットとは言えないと思います。

<!-- textlint-enable preset-ja-technical-writing/no-doubled-joshi -->

フォーマッタの振る舞いに関して、文字列リテラルにシングルクォーテーションを使う場合について考えてみましょう。
HTMLの属性はダブルクォーテーションで囲むのが一般的であるため、
HTMLにルーツを持つJSXもそれに倣う方が自然です。
実際、Prettierではデフォルト設定でJSX内の引用符はダブルクォーテーションにフォーマットされます。
しかし、現在では、[Svelte](https://svelte.jp)や[Astro](https://astro.build)といったJSXを踏襲あるいは拡張した形式を持つ、
独自の拡張子を提供するライブラリやフレームワークが続々と登場しています。
それらのファイル内でのJSX(のような)記法をフォーマットする際、
引用符はJSXと同様にダブルクォーテーションにフォーマットして欲しいため、なんらかの対応が必要です。
その点、最初からダブルクォーテーションを使えば、独自の拡張子について考慮する必要がありません。

これは考慮すべきメリットと言えそうです。しかし、Prettierの場合であれば公式やコミュニティなどによって
独自拡張子に対応するプラグインが公開されている場合が多く、そこまで手間をかけずこの問題に対応可能です。

こうやってメリットを挙げてみると、ダブルクォーテーションを使う優位性は確実にあるものの、
シングルクォーテーションの見た目の美しさを覆す程ではないかなーという気がしてきます。
現に、多くのJavaScriptコーディング規約ではシングルクォーテーションが推奨されているようです。
以上の理由から、私は文字列リテラルにはシングルクォーテーションを使っています。

## まとめ

今までの内容をまとめると、以下のようになります。

- 文字列リテラルとテンプレートリテラルを使い分け、文字列中に式を埋め込みたいときのみバッククォート文字を使う
- 文字列中に引用符を含む場合のみ、できるだけ明示的なエスケープが必要ない方を使う
- 基本的にはシングルクォーテーションとダブルクォーテーションは使い分けず、
    見た目のキレイさを重視して全てシングルクォーテーションで統一

これは私の考えなので一例に過ぎませんが、
コーディング規約の枝葉末節でもちゃんと考えて言語化しようとしてみると、
普段なんとなくで運用している基準を明確化できた気がしたので、
開発の合間にでも取り組んでみると良いかもしれません。

## 参考

- [JavaScript の文字列リテラルの使い分け（についての個人的な意見） - Qiita](https://qiita.com/unsigned-wrong-wrong-int/items/02e71c7cda570026322d)
- [テキストを扱う — JavaScript での文字列 - ウェブ開発を学ぶ | MDN](https://developer.mozilla.org/ja/docs/Learn/JavaScript/First_steps/Strings)
- [Rationale · Prettier](https://prettier.io/docs/en/rationale.html#strings)
- [スタイルガイド（コーディング規約） - TypeScript Deep Dive 日本語版](https://typescript-jp.gitbook.io/deep-dive/styleguide#semikoron)
