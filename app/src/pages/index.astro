---
import type { MarkdownInstance } from 'astro';
import * as R from 'remeda';

import List from '~/components/molecules/List.astro';
import { PAGE_TITLE } from '~/constants';
import type { Card, Frontmatter } from '~/types';

import Layout from '../layouts/Layout.astro';

const posts: MarkdownInstance<Frontmatter>[] = await Astro.glob<Frontmatter>('./posts/*/*.md');

const articles: Card[] = R.pipe(
    posts,
    R.map(({ url = '/', frontmatter }) => ({ url, ...frontmatter })), // flatten
    R.sortBy(({ createdAt }) => createdAt),
    R.reverse()
);
---

<Layout title={PAGE_TITLE} isTop={true}>
    <List cards={articles} />
</Layout>
