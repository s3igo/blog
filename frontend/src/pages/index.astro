---
import Layout from "../layouts/Layout.astro";
import type { MarkdownInstance } from "astro";
import * as R from "remeda";
import List from "~/components/molecules/List.astro";
import { PAGE_TITLE } from "~/constants";
import type { Frontmatter, Card } from "~/types";

const posts: MarkdownInstance<Frontmatter>[] = await Astro.glob<Frontmatter>("./posts/*.md");

const articles: Card[] = R.pipe(
    posts,
    // RemedaのsortByで"desc"を指定すると型情報壊れる(2023-02-07)ので、昇順にソートしてからreverseする
    R.sortBy(({ frontmatter: { createdAt } }) => createdAt),
    R.reverse(),
    R.map(({ url = "/", frontmatter }) => ({ url, ...frontmatter }))
);
---

<Layout title={PAGE_TITLE}>
    <List cards={articles} />
</Layout>
